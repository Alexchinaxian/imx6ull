#!/bin/bash
########################################################################
# 脚本名称: rebuild.sh
# 功能描述: 快速重新编译项目
# 作者: Alex
# 日期: 2025-10-15
########################################################################

echo "========================================="
echo "IMX6ULL项目快速编译"
echo "========================================="
echo ""

cd "$(dirname "$0")"

# 检查build目录
if [ ! -d "build" ]; then
    echo "✓ 创建build目录..."
    mkdir -p build
    cd build
    echo "✓ 运行CMake配置..."
    cmake ..
    if [ $? -ne 0 ]; then
        echo "❌ CMake配置失败"
        exit 1
    fi
else
    cd build
fi

echo ""
echo "✓ 开始编译..."
make -j4

if [ $? -eq 0 ]; then
    echo ""
    echo "========================================="
    echo "✅ 编译成功！"
    echo "========================================="
    echo ""
    echo "运行程序："
    echo "  cd build && ./QtImx6ullBackend"
    echo ""
else
    echo ""
    echo "========================================="
    echo "❌ 编译失败"
    echo "========================================="
    exit 1
fi
